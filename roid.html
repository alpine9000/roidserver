<html>
  <head>
    <title>Roidserver Status</title>
    <link rel="stylesheet" type="text/css" href="roid.css">
  </head>
  <body>
    <h1>Roidserver Dashboard</h1>
    <div id="status"></div>
  </body>
  <script type="text/javascript">
    function format_time(s) {
	const dtFormat = new Intl.DateTimeFormat('en-GB', {
	    dateStyle: 'short', 
	    timeStyle: 'medium',
	});
	
	return dtFormat.format(new Date(s * 1e3));
    }
    
    function updateStatus()
    {
	var opts = {
	    method: 'GET',
	    headers: {}
	};

	
	fetch('/status', opts).then(function (response) {
	    return response.text();
	}).then(function (body) {
	    document.getElementById("status").innerHTML = body;
	    var x = document.getElementsByClassName("time ");
	    var i;
	    for (i = 0; i < x.length; i++) {
		x[i].innerText = format_time(parseInt(x[i].innerText));
	    }
	});

	window.setTimeout(updateStatus, 1000);
    }
    updateStatus();
  </script>
</html>
